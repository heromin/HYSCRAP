name: ðŸŽ¬ Scraper de Animes

on:
  repository_dispatch:
    types: [importar_anime]
  workflow_dispatch:
    inputs:
      anime_name: { required: true }
      tmdb_id: { required: true }

jobs:
  scrape:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - name: InstalaciÃ³n de dependencias
        run: |
          python -m pip install --upgrade pip
          pip install requests cloudscraper beautifulsoup4 lxml animeflv
      - name: EjecuciÃ³n
        env:
          ANIME_NAME: ${{ github.event.inputs.anime_name || github.event.client_payload.anime_name }}
          TMDB_ID: ${{ github.event.inputs.tmdb_id || github.event.client_payload.tmdb_id }}
          API_URL: ${{ secrets.API_URL }}
          API_TOKEN: ${{ secrets.API_TOKEN }}
        run: python scraper.py
